{"version":3,"sources":["layout.js","lib/convert.js","lib/convert.data.js","ui/convert.js","lib/validate.js","ui/validate.js","ui/qr-reader.js","lib/qr.js","lib/data-examples.js","ui/qr-writer.js","ui/index.js","router.js","serviceWorker.js","index.js"],"names":["style","borderTop","borderBottom","boxShadow","title","menus","name","link","map","x","process","Layout","props","header","className","to","menu","i","key","Fragment","children","Header","QRType","Version","Coding","arrayToAddress","t","idx","r","AdrTp","Name","StrNameOrAdrLine1","StrNameOrAdrLine2","PstCd","TmwNm","Ctry","checkIfNull","Object","keys","k","reduce","a","b","arrayToJson","CdtrInf","IBAN","Cdtr","UltmtCdtr","UltmtDtr","CcyAmt","Ccy","Amt","AddInf","Ustrd","Trailer","SrdBkgInfo","RmtInf","Tp","Ref","AltPmtInf","AltPmt1","AltPmt2","sample","split","sampleJson","Ui","useState","text","form","handleChange","onSubmit","e","preventDefault","convert","Convert","Textarea","onChange","v","value","type","JSON","stringify","sAddress","Joi","object","string","regex","unknown","vCdtrInf","vHeader","valid","vCcyAmt","vRmtInf","optional","vAltPmtInf","allow","validate","o","schema","presence","href","Validate","parse","Test","handleScan","data","arr","j","console","log","setState","result","handleError","err","error","state","show","this","delay","onError","onScan","width","renderReader","Component","SwissQr","Array","isArray","length","config","radius","position","join","size","fgColor","bgColor","level","renderAs","includeMargin","margin","top","left","y","height","fill","dataLabels","NotFound","prefix","withRouter","path","component","QrReader","exact","Main","Boolean","window","location","hostname","match","history","History","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.204ea881.chunk.js","sourcesContent":["import React from 'react';\n\nimport { Link } from 'react-router-dom';\n\nconst style = {\n  borderTop: '1px solid #e5e5e5',\n  borderBottom: '1px solid #e5e5e5',\n  boxShadow: '0 .25rem .75rem rgba(0, 0, 0, .05)'\n}\n\nconst title = 'Swiss QR Bill';\n\nconst prefix = process.env.PUBLIC_URL || '';\n\nconst menus = [ \n  {name: 'QR Reader', link: '/qr/read'},\n  {name: 'QR Writer', link: '/qr/write'},\n  {name: 'Convert', link: '/convert'},\n  {name: 'Validate', link: '/validate'},\n].map(x => {\n  x.link = prefix + x.link;\n\n  return x;\n})\n\n\nfunction Layout(props) {\n  const header = (<header>\n    <div style={style} className=\"d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white\">\n    <h5 className=\"my-0 mr-md-auto font-weight-normal\"><Link to=\"/\">{title}</Link></h5>\n    <nav className=\"my-2 my-md-0 mr-md-3\">\n    {menus.map((menu,i) => <Link className=\"p-2 text-dark\" key={i} to={menu.link}>{menu.name}</Link>)}\n    </nav>\n  </div>\n  </header>);\n\n  return (<React.Fragment>{header}<div className=\"container\">{props.children}</div></React.Fragment>);\n}\nexport default Layout;","export const Header = {\n  QRType: 'SPC', // swiss payment code\n  Version: '0200', \n  Coding: '1'\n};\n\nexport const createJson = (CdtrInf, CcyAmt, RmtInf, UltmtDtr = undefined, UltmtCdtr = undefined, AltPmtInf = undefined) => {\n  return {\n    Header,\n    CdtrInf,\n    CcyAmt,\n    RmtInf,\n    UltmtCdtr,\n    UltmtDtr,\n    AltPmtInf\n  };\n}\n\nexport const addressToBreakSepFormat = a => {\n  const addressLabels = ['AdrTp', 'Name', 'StrNameOrAdrLine1', 'StrNameOrAdrLine2', 'PstCd', 'TmwNm', 'Ctry'];\n\n  if (!a || a === null) {\n    return addressLabels.map(_ => '');\n  }\n\n  return addressLabels.map(k => a[k]);\n}\n\nexport const jsonToBreakSepFormat = j => {\n  const Header = ['QRType', 'Version', 'Coding'].map(k => j['Header'][k]);\n  const iban = j['CdtrInf']['IBAN'];\n  const Cdtr = addressToBreakSepFormat(j['CdtrInf']['Cdtr']);\n  const UltmtCdtr = addressToBreakSepFormat(j['UltmtCdtr']);\n  const UltmtDtr = addressToBreakSepFormat(j['UltmtDtr']);\n  const CcyAmt = ['Amt', 'Ccy'].map(k => j['CcyAmt'][k]);\n  const RmtInf = ['Tp', 'Ref'].map(k => j['RmtInf'][k]);\n  const RmtInf2 = ['Ustrd', 'Trailer', 'SrdBkgInfo'].map(k => j['RmtInf']['AddInf'][k]);\n  const AltPmtInf = ['AltPmt1', 'AltPmt2'].map(k => j['AltPmtInf'][k]);\n\n  return Header.concat(iban).concat(Cdtr).concat(UltmtCdtr).concat(CcyAmt).concat(UltmtDtr).concat(RmtInf).concat(RmtInf2).concat(AltPmtInf);\n};\n\nexport const arrayToAddress = (t, idx = 0) => {\n  const r = {\n    AdrTp: t[idx],\n    Name: t[idx + 1],\n    StrNameOrAdrLine1: t[idx + 2],\n    StrNameOrAdrLine2: t[idx + 3],\n    PstCd: t[idx + 4],\n    TmwNm: t[idx + 5],\n    Ctry: t[idx + 6]\n  };\n\n  const checkIfNull = Object.keys(r).map(k => r[k] === '').reduce((a, b) => a && b);\n\n  if (checkIfNull === true) {\n    return  null;\n  }\n\n  return r;\n}\n\nexport const arrayToJson = t => {\n  const IBAN = t[3];\n  const Cdtr = arrayToAddress(t, 4);\n  const CdtrInf = { IBAN, Cdtr };\n  const UltmtCdtr = arrayToAddress(t, 11);\n  const UltmtDtr = arrayToAddress(t, 20);\n  const CcyAmt = {Ccy: t[19], Amt: t[18]};\n  const AddInf = {Ustrd: t[29], Trailer: t[30], SrdBkgInfo: t[31]};\n  const RmtInf = {Tp: t[27], Ref: t[28], AddInf};\n  const AltPmtInf = {AltPmt1: t[32], AltPmt2: t[33]};\n\n  return {\n    Header,\n    CdtrInf,\n    UltmtCdtr,\n    UltmtDtr,\n    CcyAmt,\n    RmtInf,\n    AltPmtInf\n  }\n}","import { Header } from './convert';\n\nconst sampleAddress = `S\nRobert Schneider AG\nRue du Lac\n1268\n2501\nBiel\nCH`;\n\nexport const sampleAddressArray = sampleAddress.split('\\n');\n\nexport const sampleAddressJson = {\n  AdrTp: 'S',\n  Name: 'Robert Schneider AG',\n  StrNameOrAdrLine1: 'Rue du Lac',\n  StrNameOrAdrLine2: '1268',\n  PstCd: '2501',\n  TmwNm: 'Biel',\n  Ctry: 'CH'\n};\n\nexport const sample = `SPC\n0200\n1\nCH4431999123000889012\nS\nRobert Schneider AG\nRue du Lac\n1268\n2501\nBiel\nCH\n\n\n\n\n\n\n\n1949.75\nCHF\nS\nPia-Maria Rutschmann-Schnyder\nGrosse Marktgasse\n28\n9400\nRorschach\nCH\nQRR\n210000000003139471430009017\nOrder of 15 June 2020\nEPD\n//S1/10/10201409/11/200701/20/140.000-53/30/102673831/31/200615/32/7.7/33/7.7:139.40/40/0:30\nName AV1: UV;UltraPay005;12345\nName AV2: XY;XYService;54321`;\n\nexport const sampleArray = sample.split('\\n');\n\nconst Cdtr = {\n  AdrTp: 'S',\n  Name: 'Robert Schneider AG',\n  StrNameOrAdrLine1: 'Rue du Lac',\n  StrNameOrAdrLine2: '1268',\n  PstCd: '2501',\n  TmwNm: 'Biel',\n  Ctry: 'CH'\n};\n\nconst UltmtCdtr = null;\n\nconst UltmtDtr = {\n  AdrTp: \"S\",\n  Ctry: \"CH\",\n  Name: \"Pia-Maria Rutschmann-Schnyder\",\n  PstCd: \"9400\",\n  StrNameOrAdrLine1: \"Grosse Marktgasse\",\n  StrNameOrAdrLine2: \"28\",\n  TmwNm: \"Rorschach\"\n};\n\nconst RmtInf = {\n  AddInf: {\n    SrdBkgInfo: \"//S1/10/10201409/11/200701/20/140.000-53/30/102673831/31/200615/32/7.7/33/7.7:139.40/40/0:30\",\n    Trailer: \"EPD\",\n    Ustrd: \"Order of 15 June 2020\",\n  },\n  Ref: \"210000000003139471430009017\",\n  Tp: \"QRR\"\n};\n\nconst AltPmtInf = {\n  AltPmt1: \"Name AV1: UV;UltraPay005;12345\",\n  AltPmt2: \"Name AV2: XY;XYService;54321\"\n};\n\nconst CcyAmt = {\n  Amt: \"1949.75\",\n  Ccy: \"CHF\",\n};\n\nconst CdtrInf = {\n  IBAN: 'CH4431999123000889012',\n  Cdtr\n};\n\nexport const sampleJson = {\n  Header,\n  CdtrInf,\n  CcyAmt,\n  UltmtDtr,\n  UltmtCdtr,\n  RmtInf,\n  AltPmtInf\n};\n","import React, { useState } from 'react';\n\nimport * as UI from '@nexys/uibs4';\nimport * as Convert from '../lib/convert';\nimport { sample } from '../lib/convert.data';\n\nfunction Ui() {\n  const [ form, handleChange] = useState({text: sample});\n\n  const handleSubmit = e => {\n    e.preventDefault();\n\n    const convert = Convert.arrayToJson(form.text.split('\\n'));\n\n    handleChange({...form, convert});\n  }\n\n  return (<div>\n    <h3>Converts output (break line separated text) into JSON</h3>\n    <div className=\"row\">\n      <div className=\"col-md-6\">\n        <form onSubmit={handleSubmit}>\n          <UI.Form.Textarea onChange={(v) => handleChange({...form, text: v.value})} name=\"text\" value={form.text}/>\n          <button type=\"submit\" className=\"btn btn-primary\">Convert</button>\n        </form>\n      </div>\n      <div className=\"col-md-6\">\n        <pre>{JSON.stringify(form.convert, null, 2)}</pre>\n      </div>\n    </div>\n  </div>);\n}\n\nexport default Ui;","import Joi from '@hapi/joi';\n\n// the different defitions are taken from https://www.paymentstandards.ch/dam/downloads/ig-qr-bill-en.pdf#page=25\n\n// note1: even though the standards describes a \"break-line\" separated format. I think it is best to represent it as a json with the structure they suggest in the `Data Structure` of the Doc so that the validation becomes easier\n// note2: the following groups: UltmtCdtr, UltmtDbtr and CdtrInf:Cdtr are the same (this is not explicitly stated in the documentation)\n// note3: this is a first version and is not complete, PR welcome!\n\nexport const sAddress = Joi.object({\n  AdrTp: Joi.string().regex(/^[ST]$/),\n  Ctry: Joi.string().regex(/^[A-Z]{2}$/),\n  Name: Joi.string(),\n  PstCd: Joi.string(),\n  StrNameOrAdrLine1: Joi.string(),\n  StrNameOrAdrLine2: Joi.string(),\n  TmwNm: Joi.string()\n}).unknown(true);\n\nexport const vCdtrInf = Joi.object({\n  IBAN: Joi.string().regex(/[a-zA-Z]{2}[0-9]{2}[a-zA-Z0-9]{4}[0-9]{7}([a-zA-Z0-9]?){0,16}/),\n  Cdtr: sAddress\n});\n\nexport const vHeader = Joi.object({\n  QRType: Joi.string().valid('SPC'),\n  Version: Joi.string().regex(/^\\d{4}$/).valid('0200'), //, only check for version 0200\n  Coding: Joi.string().regex(/^1$/),\n});\n\nexport const vCcyAmt = Joi.object({\n  Amt: Joi.string().regex(/^\\d+\\.\\d{2}$/),\n  Ccy: Joi.string().regex(/^[A-Z]{3}$/)\n});\n\nexport const vRmtInf = Joi.object({\n  AddInf: Joi.object({\n    SrdBkgInfo: Joi.string().optional(),\n    Trailer: Joi.string().valid('EPD'),\n    Ustrd: Joi.string().optional()\n  }),\n  Ref: Joi.string().optional(),\n  Tp: Joi.string().valid('QRR')\n});\n\nexport const vAltPmtInf = Joi.object({\n  AltPmt1: Joi.string().optional(),\n  AltPmt2: Joi.string().optional()\n});\n\nexport const sampleJson = Joi.object({\n  Header: vHeader,\n  CdtrInf: vCdtrInf,\n  CcyAmt: vCcyAmt,\n  UltmtDtr: sAddress.allow(null).optional(),\n  UltmtCdtr: sAddress.allow(null).optional(),\n  RmtInf: vRmtInf,\n  AltPmtInf: vAltPmtInf\n});\n\n/**\n * validates the schema\n * @param  schema : schema \n * @param  o : object to be validated\n * @return Joi output\n */\nexport const validate = (o, schema = sampleJson) => schema.validate(o, { presence: 'required'});\n\n/**\n * validates the schema\n * @param  schema : schema \n * @param  o : object to be validated\n * @return boolean\n */\nexport const validateBoolean = (o, schema = sampleJson) => validate(o, schema).error === null;\n","import React, { useState } from 'react';\n\nimport * as UI from '@nexys/uibs4';\nimport * as Validate from '../lib/validate';\nimport { sampleJson } from '../lib/convert.data';\n\nfunction Ui() {\n  const [ form, handleChange] = useState({text: JSON.stringify(sampleJson, null, 2)});\n\n  const handleSubmit = e => {\n    e.preventDefault();\n\n    const validate = Validate.validate(JSON.parse(form.text));\n\n    handleChange({...form, validate});\n  }\n\n  return (<div>\n    <h3>Validate JSON with JOI</h3>\n    <p>see source <a href=\"https://github.com/Nexysweb/qrbill/blob/master/src/lib/validate.js\">here</a></p>\n    <div className=\"row\">\n      <div className=\"col-md-6\">\n        <form onSubmit={handleSubmit}>\n          <UI.Form.Textarea onChange={(v) => handleChange({...form, text: v.value})} name=\"text\" value={form.text}/>\n          <button type=\"submit\" className=\"btn btn-primary\">Validate</button>\n        </form>\n      </div>\n      <div className=\"col-md-6\">\n        <h4>Output of JOI after validating</h4>\n        <pre>{JSON.stringify(form.validate, null, 2)}</pre>\n      </div>\n    </div>\n  </div>);\n}\n\nexport default Ui;","import React, { Component } from 'react';\nimport QrReader from 'react-qr-reader';\n\nimport * as Validate from '../lib/validate';\nimport { arrayToJson } from '../lib/convert';\n \nexport default class Test extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      show: true,\n      result: 'No result'\n    }\n  }\n \n  handleScan = data => {\n    if (data) {\n      const arr = data.split('\\n');\n      const j = arrayToJson(arr);\n\n      console.log(j)\n\n      if (Validate.validate(Validate.sampleJson, j)) {\n        this.setState({\n          result: j\n        });\n      } else {\n        this.setState({result: 'The QR Code read is not a valid Swiss QRBIll'});\n      }\n    }\n  }\n\n  handleError = err => {\n    console.error(err)\n  }\n\n  renderReader() {\n    if (this.state.show) {\n      return <QrReader\n        delay={300}\n        onError={this.handleError}\n        onScan={this.handleScan}\n        style={{ width: '300px' }}\n      />\n    };\n\n    return null;\n  }\n\n  toggleReader() {\n    const show = !this.state.show;\n    this.setState({show});\n\n  }\n\n  render() {\n    console.log(this.state.result)\n    return (\n      <div>\n        {this.renderReader()}\n        <pre>{JSON.stringify(this.state.result, null, 2)}</pre>\n        \n      </div>\n    )\n  }\n}","import React from 'react';\n\nimport QRCode from 'qrcode.react';\n\n// swiss qr code should be 46 x 46 mm and the cross 7 x 7 mmm in the middle\n\n// this is a quick wrapper around the qrcode generator for the generation f qqr code with JSON cntent\nfunction SwissQr(props) {\n  const { value } = props;\n\n  if (!Array.isArray(value) || value.length !== 34) {\n    console.error('an array is expected as input');\n    return null;\n  }\n\n  const size = 300;\n\n  const config = {\n    fgColor: '#000000',\n    bgColor: '#ffffff',\n    level: 'M',\n    renderAs: 'svg',\n    includeMargin: false,\n  };\n\n  const radius = size/46*7;\n  const ratioCross = 1.1/5;\n\n  return <div className=\"svgHolder\" style={{position: 'relative'}}>\n    <QRCode\n      value={value.join('\\n')}\n      size={size}\n      fgColor={config.fgColor}\n      bgColor={config.bgColor}\n      level={config.level}\n      renderAs={config.renderAs}\n      includeMargin={config.includeMargin}\n    />\n    <svg style={{margin: '0 auto', position: 'absolute', top: (150-radius) + 'px', left: (150-radius) + 'px'}}>\n      <rect x={radius/2 - 1/10*radius} y={radius/2 - 1/10*radius} width={radius*1.2} height={radius*1.2} r={radius} fill=\"white\"/>\n      <rect x={radius/2} y={radius/2} width={radius} height={radius} r={radius} fill=\"black\"/>\n      <rect x={radius/2 + radius/2 - ratioCross/2*radius} y={radius/2 + ratioCross/2*radius} width={ratioCross*radius} height={(1-ratioCross)*radius} fill=\"white\"/>\n      <rect x={radius/2 + ratioCross/2*radius} y={radius/2 + radius/2 - ratioCross/2*radius} width={(1-ratioCross)*radius} height={ratioCross*radius} fill=\"white\"/>\n    </svg>\n  </div>;\n}\n\nexport default SwissQr;","// this is the example that is displayed on p. xx of the english guide\n// actually displays the labels in french\nexport const dataLabels = [\n  'QRType',\n  'Version',\n  'Coding Type',\n  'Compte (IBAN CRE)',\n  'Type d\\'adresse (CRE)',\n  'Nom (CRE)',\n  'Rue ou ligne d\\'adresse 1 (CRE)',\n  'Numéro de maison ou ligne d\\'adresse 2 (CRE)',\n  'Code postale (CRE)',\n  'Lieu (CRE)',\n  'Pays (CRE)',\n  'Type d\\'adresse (CREF)',\n  'Nom (CREF)',\n  'Rue ou ligne d\\'adresse 1 (CREF)',\n  'Numéro de maison ou ligne d\\'adresse 2 (CREF)',\n  'Code postale (CREF)',\n  'Lieu (CREF)',\n  'Pays (CREF)',\n  'Montant',\n  'Monnaie',\n  'Type d\\'adresse (DEBF)',\n  'Nom (DEBF)',\n  'Rue ou ligne d\\'adresse 1 (DEBF)',\n  'Numéro de maison ou ligne d\\'adresse 2 (DEBF)',\n  'Code postale (DEBF)',\n  'Lieu (DEBF)',\n  'Pays (DEBF)',\n  'Type de référence',\n  'Référence',\n  'Communication non structurée',\n  'Trailer',\n  'Informations de facture',\n  'PA1 – Paramètres',\n  'PA2 – Paramètres'\n];\n\n// this is the example that is displayed on fig 14 p.39 of the english guide\n// sample\nexport const example = [\n  'SPC',\n  '0200',\n  '1',\n  'CH4431999123000889012',\n  'S',\n  'Robert Schneider AG',\n  'Rue du Lac',\n  '1268',\n  '2501',\n  'Biel',\n  'CH',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '',\n  '1949.75',\n  'CHF',\n  'S',\n  'Pia-Maria Rutschmann-Schnyder',\n  'Grosse Marktgasse',\n  '28',\n  '9400',\n  'Rorschach',\n  'CH',\n  'QRR',\n  '210000000003139471430009017',\n  'Order of 15 June 2020',\n  'EPD',\n  '//S1/10/10201409/11/200701/20/140.000-53/30/102673831/31/200615/32/7.7/33/7.7:139.40/40/0:30',\n  'Name AV1: UV;UltraPay005;12345',\n  'Name AV2: XY;XYService;54321'\n];","import React from 'react';\n\nimport QR from '../lib/qr';\nimport * as Convert from '../lib/convert';\nimport { dataLabels } from '../lib/data-examples';\n\n// swiss qr code should be 46 x 46 mm and the cross 7 x 7 mmm in the middle\n\n// this is a quick wrapper around the qrcode generator for the generation f qqr code with JSON cntent\nfunction SwissQr() {\n\n  console.log(dataLabels)\n\n  return <div className=\"row\">\n    <div className=\"col-md-6\">\n      <h3> Generated Swiss QR</h3>\n      <QR value={dataLabels}/>\n    </div>\n    <div className=\"col-md-6\">\n      <h3>QR Content <small>as JSON</small></h3>\n      <pre>{JSON.stringify(Convert.arrayToJson(dataLabels), null, 2)}</pre>\n    </div>\n  </div>;\n}\n\nexport default SwissQr;","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nexport default () => (<div>\n  <p>Here you can play with different tools to understand the Swiss QR Bill</p>\n  <p><b><Link to=\"/qr/read\">Click here</Link> if you would like to read a Swiss QR Code</b></p>\n\n  <p>Browse the menu for more options</p>\n\n  <p>Do you need help with the transition to the new <a href=\"https://www.six-group.com/interbank-clearing/en/home/standardization/payment-slips.html\">QR Bill</a> and in general <a href=\"https://www.six-group.com/interbank-clearing/en/home/standardization/iso-payments.html\">ISO20022</a>? Please get in touch at <a href=\"info@nexys.ch\">info [@] nexys.ch</a></p>\n\n</div>);","import React from 'react';\nimport {\n  Switch,\n  Route,\n  withRouter\n} from 'react-router-dom';\n\nimport Layout from './layout';\n\nimport Convert from './ui/convert';\nimport Validate from './ui/validate';\nimport QrReader from './ui/qr-reader';\nimport QrWriter from './ui/qr-writer';\nimport Main from './ui';\n\nimport { dataLabels } from './lib/data-examples';\n\nconst NotFound = () => <p>Page Not Found</p>;\n\n\nconst prefix = process.env.PUBLIC_URL || '';\n\nfunction Router(props) {\n  return (<Layout>\n    <Switch>\n      <Route path={prefix + '/qr/read'} component={QrReader} props={props} />\n      <Route path={prefix + '/qr/write'} component={() => <QrWriter value={dataLabels}/>} props={props} />\n      <Route path={prefix + '/convert'} component={Convert} props={props} />\n      <Route path={prefix + '/validate'} component={Validate} props={props} />\n      <Route exact path={prefix + '/'} component={Main} />\n      <Route path=\"/\" component={NotFound} />\n    </Switch>\n  </Layout>);\n}\n\nexport default withRouter(Router);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { Router } from 'react-router-dom';\nimport * as History from 'history';\n\nimport RouterApp from './router';\nimport * as serviceWorker from './serviceWorker';\n\nconst history = History.createBrowserHistory();\n\nReactDOM.render(<Router history={history}><RouterApp/></Router>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}